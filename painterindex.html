<!doctype html> 
 <html lang="zh-CN"> 
 <head> 
   <meta charset="utf-8" /> 
   <meta name="viewport" content="width=device-width,initial-scale=1" /> 
   <title>点阵画图 — 首页</title> 
   <meta name="description" content="轻量的点阵（像素）画图工具。快速开始、模板、示例画廊与使用帮助。" /> 
   <style> 
     :root{ 
       --bg:#0f1724; 
       --card:#0b1220; 
       --accent:#22c1c3; 
       --muted:#9aa6b2; 
       --glass: rgba(255,255,255,0.03); 
       --radius:14px; 
       font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; 
     } 
     *{box-sizing:border-box} 
     html,body{height:100%;margin:0;background: 
       radial-gradient(1200px 600px at 10% 20%, rgba(34,193,195,0.06), transparent), 
       linear-gradient(180deg,#071123 0%, #071323 100%); 
       color:#e6eef3;font-smoothing:antialiased;} 
     .wrap{max-width:1100px;margin:36px auto;padding:28px;display:grid;grid-template-columns:1fr 420px;gap:20px;} 
     header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between;gap:12px} 
     .brand{display:flex;gap:12px;align-items:center} 
     .logo{ 
       width:52px;height:52px;border-radius:10px; 
       background:linear-gradient(135deg,var(--accent),#6a5cff); 
       display:flex;align-items:center;justify-content:center;font-weight:700;color:#051219; 
       box-shadow:0 6px 18px rgba(12,20,30,0.6); 
     } 
     h1{margin:0;font-size:20px} 
     p.lead{margin:4px 0 0;color:var(--muted);font-size:13px} 
     /* hero */ 
     .hero{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:22px;border-radius:var(--radius);box-shadow:0 6px 20px rgba(0,0,0,0.45);} 
     .hero-grid{display:flex;gap:18px;align-items:center} 
     .hero-left{flex:1} 
     .cta-row{margin-top:14px;display:flex;gap:10px;align-items:center;flex-wrap:wrap} 
     .btn{padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600} 
     .btn-primary{background:linear-gradient(90deg,var(--accent),#6a5cff);color:#052025} 
     .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)} 
     .sub{font-size:13px;color:var(--muted);margin-top:8px} 
     /* right panel (quick actions) */ 
     .panel{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.5);} 
     .quick-list{display:flex;flex-direction:column;gap:10px} 
     .preset{display:flex;gap:12px;align-items:center} 
     .thumb{width:64px;height:64px;border-radius:8px;background:var(--glass);display:flex;align-items:center;justify-content:center;overflow:hidden;border:1px solid rgba(255,255,255,0.02)} 
     .preset-info{flex:1} 
     .preset-info div{font-size:13px} 
     .small{font-size:12px;color:var(--muted)} 
     /* gallery */ 
     .gallery{margin-top:18px;display:grid;grid-template-columns:repeat(3,1fr);gap:12px} 
     .card{background:var(--card);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.02);display:flex;flex-direction:column;gap:8px;align-items:center} 
     .canvas-preview{width:140px;height:140px;border-radius:8px;overflow:hidden;background:linear-gradient(90deg,#fff,#fff);image-rendering:pixelated;display:flex;align-items:center;justify-content:center} 
     footer{grid-column:1/-1;margin-top:18px;color:var(--muted);font-size:13px;display:flex;justify-content:space-between;align-items:center} 
     /* responsive */ 
     @media (max-width:980px){ 
       .wrap{grid-template-columns:1fr;padding:18px} 
       .brand h1{font-size:18px} 
       .hero-grid{flex-direction:column} 
     } 
   </style> 
 </head> 
 <body> 
   <main class="wrap"> 
     <header> 
      <div class="brand"> 
        <div class="logo">LM</div>
        <div>
          <h1>LM点阵画图</h1>
          <p class="lead">轻量、直观的像素画编辑器 — 适合图标、表情与像素艺术创作。</p>
        </div>
      </div> 
      <nav> 
        <button class="btn btn-ghost" id="navOpenEditorBtn">点阵画图</button> 
        <button class="btn btn-ghost" id="navOpenDrawBtn">普通画图</button> 
      </nav> 
     </header> 

     <section class="hero"> 
       <div class="hero-grid"> 
         <div class="hero-left"> 
           <h2 style="margin:0 0 8px">马上开始你的像素创作</h2> 
           <p class="sub">选择预设或自定义网格，快速进入编辑器并开始绘制。支持保存/加载 LM。</p> 

           <div class="cta-row"> 
             <button class="btn btn-primary" id="heroOpenEditorBtn">点阵画图</button> 
             <button class="btn btn-ghost" id="heroOpenDrawBtn">普通画图</button> 
             <button class="btn btn-ghost" id="openTutorial">查看教程</button> 
           </div> 

           <p class="sub" style="margin-top:12px">也可以把页面保存为书签，随时打开继续创作。支持触摸和桌面设备。</p> 
         </div>
       </div>

       <div style="margin-top:14px;display:flex;gap:12px;align-items:center;flex-wrap:wrap">
         <div style="color:var(--muted);font-size:13px">特色：</div>
         <div class="small" style="background:rgba(255,255,255,0.02);padding:8px;border-radius:8px">网格自定义</div>
         <div class="small" style="background:rgba(255,255,255,0.02);padding:8px;border-radius:8px">撤销/重做</div>
         <div class="small" style="background:rgba(255,255,255,0.02);padding:8px;border-radius:8px">保存/加载 LM</div>
         <div class="small" style="background:rgba(255,255,255,0.02);padding:8px;border-radius:8px">触摸与鼠标支持</div>
         <div class="small" style="background:rgba(255,255,255,0.02);padding:8px;border-radius:8px">像素值查看</div>
       </div>
     </section> 

     <footer> 
       <div>版本: 1.0</div> 
       <div>&copy; 2025 LM点阵画图</div> 
     </footer> 
   </main> 

   <script> 
     // ---------- 配置 ---------- 
     // 假设编辑器文件名为 "index.html"（你之前的画图文件）， 
     // 如果编辑器文件为 editor.html 或 pixel-editor.html，请修改 editFile 变量。 
     const editFile = 'painter.html'; 

     // ---------- 简化版验证系统 ---------- 
     let isVerified = false;
     let pendingUrl = null;

     // 验证配置
     const verificationConfig = {
       gridSize: 3,
       objects: ['狗', '自行车', '风景', '汽车', '房屋'],
       colors: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7'],
       totalCells: 9
     };

     // 创建验证弹窗
     function createVerificationModal() {
       // 检查是否已存在
       if (document.getElementById('verificationModal')) {
         return;
       }

       // 随机选择一个验证对象
       const randomObjectIndex = Math.floor(Math.random() * verificationConfig.objects.length);
       const targetObject = verificationConfig.objects[randomObjectIndex];
       const targetColor = verificationConfig.colors[randomObjectIndex];

       // 随机生成正确答案（3-5个随机单元格）
       const correctCells = new Set();
       const correctCount = Math.floor(Math.random() * 3) + 3; // 3-5个正确单元格
       while (correctCells.size < correctCount) {
         correctCells.add(Math.floor(Math.random() * verificationConfig.totalCells));
       }
       const correctCellsArray = Array.from(correctCells);

       const modal = document.createElement('div');
       modal.id = 'verificationModal';
       modal.style.cssText = `
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(0, 0, 0, 0.8);
         display: flex;
         align-items: center;
         justify-content: center;
         z-index: 1000;
         font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
       `;

       const modalContent = document.createElement('div');
       modalContent.style.cssText = `
         background: #fff;
         border-radius: 4px;
         width: 90%;
         max-width: 400px;
         overflow: hidden;
         box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
       `;

       // 头部
       const modalHeader = document.createElement('div');
       modalHeader.style.cssText = `
         padding: 16px;
         border-bottom: 1px solid #e0e0e0;
         background: #f8f9fa;
       `;

       const title = document.createElement('h2');
       title.textContent = '人机验证';
       title.style.cssText = `
         margin: 0;
         font-size: 18px;
         font-weight: 400;
         color: #202124;
       `;

       modalHeader.appendChild(title);
       modalContent.appendChild(modalHeader);

       // 主体
       const modalBody = document.createElement('div');
       modalBody.style.cssText = `
         padding: 20px;
       `;

       const description = document.createElement('p');
       description.innerHTML = `
         请选择包含<strong>"${targetObject}"</strong>文字的所有图片块。<br>
         如果没有，请点击"跳过"。
       `;
       description.style.cssText = `
         margin: 0 0 20px 0;
         font-size: 14px;
         color: #5f6368;
         text-align: center;
         line-height: 1.5;
       `;

       // 图片网格容器
       const gridContainer = document.createElement('div');
       gridContainer.id = 'verificationGrid';
       gridContainer.style.cssText = `
         display: grid;
         grid-template-columns: repeat(${verificationConfig.gridSize}, 1fr);
         gap: 1px;
         background: #e0e0e0;
         margin-bottom: 15px;
         border-radius: 4px;
         overflow: hidden;
       `;

       // 已选择的单元格
       const selectedCells = new Set();

       // 创建单元格
       for (let i = 0; i < verificationConfig.totalCells; i++) {
         const cell = document.createElement('div');
         cell.className = 'verificationCell';
         cell.dataset.cellIndex = i;
         
         // 如果是正确单元格，显示对象名称，否则显示空白
         const isCorrect = correctCells.has(i);
         cell.innerHTML = isCorrect ? targetObject : '';
         
         cell.style.cssText = `
           width: 80px;
           height: 80px;
           background: ${isCorrect ? targetColor : '#f5f5f5'};
           display: flex;
           align-items: center;
           justify-content: center;
           font-size: 16px;
           font-weight: bold;
           color: ${isCorrect ? '#fff' : '#999'};
           cursor: pointer;
           position: relative;
           transition: all 0.2s ease;
           border: 1px solid #e0e0e0;
         `;

         // 添加点击事件
         cell.addEventListener('click', () => {
           const cellIndex = parseInt(cell.dataset.cellIndex);
           if (selectedCells.has(cellIndex)) {
             // 取消选择
             selectedCells.delete(cellIndex);
             cell.style.border = '1px solid #e0e0e0';
             cell.style.transform = 'scale(1)';
           } else {
             // 选择
             selectedCells.add(cellIndex);
             cell.style.border = '3px solid #1a73e8';
             cell.style.transform = 'scale(1.05)';
           }
         });

         gridContainer.appendChild(cell);
       }

       // 控制按钮
       const controls = document.createElement('div');
       controls.style.cssText = `
         display: flex;
         justify-content: space-between;
         align-items: center;
         margin-top: 15px;
       `;

       // 刷新按钮
       const refreshBtn = document.createElement('button');
       refreshBtn.innerHTML = '↻';
       refreshBtn.style.cssText = `
         width: 40px;
         height: 40px;
         border: 1px solid #dadce0;
         background: white;
         border-radius: 4px;
         cursor: pointer;
         font-size: 18px;
         display: flex;
         align-items: center;
         justify-content: center;
         transition: all 0.2s ease;
       `;
       refreshBtn.addEventListener('click', () => {
         document.body.removeChild(modal);
         createVerificationModal();
       });

       // 跳过按钮
       const skipBtn = document.createElement('button');
       skipBtn.textContent = '跳过';
       skipBtn.style.cssText = `
         padding: 10px 20px;
         border: 1px solid #dadce0;
         background: white;
         border-radius: 4px;
         cursor: pointer;
         font-size: 14px;
         color: #5f6368;
         transition: all 0.2s ease;
       `;
       skipBtn.addEventListener('click', () => {
         document.body.removeChild(modal);
       });

       // 验证按钮
       const verifyBtn = document.createElement('button');
       verifyBtn.id = 'verifyBtn';
       verifyBtn.textContent = '验证';
       verifyBtn.style.cssText = `
         padding: 10px 20px;
         border: none;
         background: #1a73e8;
         color: white;
         border-radius: 4px;
         cursor: pointer;
         font-size: 14px;
         font-weight: 500;
         transition: all 0.2s ease;
       `;
       verifyBtn.addEventListener('click', () => {
         // 验证逻辑：检查选择的单元格是否与正确答案匹配
         const selectedArray = Array.from(selectedCells);
         const isCorrect = selectedArray.every(cell => correctCells.has(cell)) && 
                          selectedArray.length === correctCells.size;
         
         if (isCorrect) {
           isVerified = true;
           document.body.removeChild(modal);
           // 如果有等待打开的链接，直接打开
           if (pendingUrl) {
             window.open(pendingUrl, '_blank');
             pendingUrl = null;
           }
         } else {
           // 验证失败，重新生成
           alert('验证失败，请重试');
           document.body.removeChild(modal);
           createVerificationModal();
         }
       });

       controls.appendChild(refreshBtn);
       controls.appendChild(skipBtn);
       controls.appendChild(verifyBtn);

       modalBody.appendChild(description);
       modalBody.appendChild(gridContainer);
       modalBody.appendChild(controls);
       modalContent.appendChild(modalBody);
       modal.appendChild(modalContent);
       document.body.appendChild(modal);
     }

     // 检查验证并打开链接
     function checkVerificationAndOpen(url) {
       if (isVerified) {
         window.open(url, '_blank');
       } else {
         pendingUrl = url;
         createVerificationModal();
       }
     }

     // 绑定按钮 
     document.getElementById('navOpenEditorBtn').addEventListener('click', ()=>{ 
       checkVerificationAndOpen(editFile);
     }); 

     document.getElementById('heroOpenEditorBtn').addEventListener('click', ()=>{ 
       checkVerificationAndOpen(editFile);
     }); 

     // 普通画图按钮事件监听器
     document.getElementById('navOpenDrawBtn').addEventListener('click', ()=>{ 
       checkVerificationAndOpen('draw.html');
     }); 

     document.getElementById('heroOpenDrawBtn').addEventListener('click', ()=>{ 
       checkVerificationAndOpen('draw.html');
     }); 

     document.getElementById('openTutorial').addEventListener('click', ()=>{ 
       alert('快速教程：选择铅笔并选择颜色；鼠标拖绘以着色；按 Z 撤销，Y 重做；保存 LM 保存作品。'); 
     }); 
   </script> 
 </body> 
 </html>
